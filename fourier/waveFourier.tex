%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
\chapter{Fourier transform solutions to the wave equation}
\index{Fourier transform!wave equation}
\index{wave equation!Fourier transform}
\label{chap:PJwaveFourier}
%\date{Jan 26, 2009.  waveFourier.tex}

\section{Mechanical wave equation solution}

We want to solve

\begin{equation}\label{eqn:wave_fourier:waveTwoDim}
\begin{aligned}
\left(\inv{v^2} \partial_{tt} - \partial_{xx}\right) \psi = 0
\end{aligned}
\end{equation}

A separation of variables treatment of this has been done in
\chapcite{PJwaveFourVector}, and some logical followup for that done in
\chapcite{PJemWave} in the context of Maxwell's equation for the vacuum field.

Here the Fourier transform will be used as a tool.

\section{One dimensional case}

Following the heat equation treatment in \chapcite{PJheatFourier}, we take Fourier transforms
of both parts of \eqnref{eqn:wave_fourier:waveTwoDim}.

\begin{equation}\label{eqn:waveFourier:23}
\begin{aligned}
\calF\left( \inv{v^2} \partial_{tt} \psi \right) = \calF\left( \partial_{xx} \psi \right)
\end{aligned}
\end{equation}

For the \(x\) derivatives we can integrate by parts twice

\begin{equation}\label{eqn:waveFourier:43}
\begin{aligned}
\calF\left( \partial_{xx} \psi \right)
&= \inv{\sqrt{2 \pi}} \IIinf \left( \partial_{xx} \psi \right) \exp\left( -i k x \right) dx \\
&= -\inv{\sqrt{2 \pi}} \IIinf \left( \partial_{x} \psi \right) \partial_x\left(\exp\left( -i k x \right) \right) dx \\
&= -\frac{-i k}{\sqrt{2 \pi}} \IIinf \left( \partial_{x} \psi \right) \exp\left( -i k x \right) dx \\
&= \frac{(-i k)^2}{\sqrt{2 \pi}} \IIinf \psi \exp\left( -i k x \right) dx \\
\end{aligned}
\end{equation}

Note that this integration by parts requires that \(\partial_x \psi = \psi = 0\) at \(\pm \infty\).  We are left with

\begin{equation}\label{eqn:waveFourier:63}
\begin{aligned}
\calF\left( \partial_{xx} \psi \right) &= -k^2 \hat{\psi}(k, t)
\end{aligned}
\end{equation}

Now, for the left hand side, for the Fourier transform of the time partials we can pull the derivative operation out of the
integral

\begin{equation}\label{eqn:waveFourier:83}
\begin{aligned}
\calF\left( \inv{v^2} \partial_{tt} \psi \right)
&= \inv{\sqrt{2 \pi}} \IIinf \left( \inv{v^2} \partial_{tt} \psi \right) \exp\left( -i k x \right) dx \\
&= \inv{v^2} \partial_{tt} \hat{\psi}(k,t) \\
\end{aligned}
\end{equation}

We are left with our harmonic oscillator differential equation for the transformed wave function

\begin{equation}\label{eqn:waveFourier:103}
\begin{aligned}
\inv{v^2} \partial_{tt} \hat{\psi}(k,t) &= -k^2 \hat{\psi}(k, t).
\end{aligned}
\end{equation}

Since we have a partial differential equation, for the integration constant we are free to pick any function of \(k\).  The solutions of this are therefore of the form

\begin{equation}\label{eqn:waveFourier:123}
\begin{aligned}
\hat{\psi}(k,t) &= A(k) \exp\left( \pm i v k t \right)
\end{aligned}
\end{equation}

Performing an inverse Fourier transform we now have the wave equation expressed in terms of this unknown (so far) frequency domain function \(A(k)\).  That is

\begin{equation}\label{eqn:wave_fourier:almostThere}
\begin{aligned}
{\psi}(x,t) &= \inv{\sqrt{2\pi}} \IIinf A(k) \exp\left( \pm i v k t + i k x \right) dk
\end{aligned}
\end{equation}

Now, suppose we fix the boundary value conditions by employing a known value of the wave function at \(t = 0\), say \(\psi(x,0) = \phi(x)\).  We then have

\begin{equation}\label{eqn:waveFourier:143}
\begin{aligned}
{\phi}(x) &= \inv{\sqrt{2\pi}} \IIinf A(k) \exp\left( i k x \right) dk
\end{aligned}
\end{equation}

From which we have \(A(k)\) in terms of \(\phi\) by inverse transform

\begin{equation}\label{eqn:wave_fourier:freqInitial}
\begin{aligned}
A(k) &= \inv{\sqrt{2\pi}} \IIinf \phi(x) \exp\left( -i k x \right) dx
\end{aligned}
\end{equation}

One could consider the problem fully solved at this point, but it can be carried further.  Let us substitute
\eqnref{eqn:wave_fourier:freqInitial} back into \eqnref{eqn:wave_fourier:almostThere}.  This is

\begin{equation}\label{eqn:waveFourier:163}
\begin{aligned}
{\psi}(x,t) &= \inv{\sqrt{2\pi}} \IIinf \left( \inv{\sqrt{2\pi}} \IIinf \phi(u) \exp\left( -i k u \right) du \right) \exp\left( \pm i v k t + i k x \right) dk
\end{aligned}
\end{equation}

With the Rigor police on holiday, exchange the order of integration

\begin{equation}\label{eqn:waveFourier:183}
\begin{aligned}
{\psi}(x,t)
&= \IIinf \phi(u) du \inv{{2\pi}} \IIinf \exp\left( -i k u \pm i v k t + i k x \right) dk \\
&= \IIinf \phi(u) du \inv{{2\pi}} \IIinf \exp\left( i k (x - u \pm v t ) \right) dk \\
\end{aligned}
\end{equation}

The principle value of this inner integral is

\begin{equation}\label{eqn:waveFourier:203}
\begin{aligned}
\PV \inv{{2\pi}} \IIinf \exp\left( i k (x - u \pm v t ) \right) dk
&= \lim_{R\rightarrow \infty} \inv{2\pi} \int_{-R}^R \exp\left( i k (x - u \pm v t ) \right) dk  \\
&= \lim_{R\rightarrow \infty} \frac{\sin\left( R (x - u \pm v t ) \right) }{ \pi (x - u \pm v t) } \\
\end{aligned}
\end{equation}

And here we make the usual identification with the delta function \(\delta( x - u \pm v t )\).  We are left with

\begin{equation}\label{eqn:waveFourier:223}
\begin{aligned}
{\psi}(x,t)
&= \IIinf \phi(u) \delta( x - u \pm v t ) du \\
&= \phi( x \pm v t )
\end{aligned}
\end{equation}

We find, amazingly enough, just by application of the Fourier transform, that the time evolution of the
wave function follows propagation of the initial wave packet down the x-axis in one of the two directions with velocity \(v\).

This is a statement well known to any first year student taking a vibrations and waves course, but it is nice to see
it follow from the straightforward application of transform techniques straight out of the Engineer's toolbox.

\section{Two dimensional case}

Next, using a two dimensional Fourier transform

\begin{equation}\label{eqn:waveFourier:243}
\begin{aligned}
\hat{f}(k,m) &= \inv{(\sqrt{2\pi})^2} \IIinf f(x,y) \exp\left( -i k x - i m y \right) dx dy \\
{f}(x,y) &= \inv{(\sqrt{2\pi})^2} \IIinf \hat{f}(k,m) \exp\left( i k x + i m y \right) dk dm,
\end{aligned}
\end{equation}

let us examine the two dimensional wave equation

\begin{equation}\label{eqn:waveFourier:263}
\begin{aligned}
\calF\left( \left(\inv{v^2} \partial_{tt} -\partial_{xx} -\partial_{yy} \right)\psi = 0 \right)
\end{aligned}
\end{equation}

Applying the same technique as above we have

\begin{equation}\label{eqn:waveFourier:283}
\begin{aligned}
\inv{v^2}\partial_{tt}\hat{\psi}(k,m,t) = \left((-i k)^2 + (-i m)^2\right) \hat{\psi}(k,m,t)
\end{aligned}
\end{equation}

With a solution

\begin{equation}\label{eqn:waveFourier:303}
\begin{aligned}
\hat{\psi}(k,m,t) = A(k,m) \exp\left( \pm i \sqrt{k^2 + m^2} v t \right).
\end{aligned}
\end{equation}

Inverse transforming we have our spatial domain function

\begin{equation}\label{eqn:waveFourier:323}
\begin{aligned}
{\psi}(x,y,t) = \inv{(\sqrt{2\pi})^2} \IIinf A(k,m) \exp\left( i k x + i m y \pm i \sqrt{k^2 + m^2} v t \right) dk dm
\end{aligned}
\end{equation}

Again introducing an initial value function \(\psi(x,y,0) = \phi(x,y)\) we have

\begin{equation}\label{eqn:waveFourier:343}
\begin{aligned}
A(k,m)
&= \hat{\phi}(k,m) \\
&= \inv{(\sqrt{2\pi})^2} \IIinf \phi(u,w) \exp\left( -i k u - i m w \right) du dw
\end{aligned}
\end{equation}

From which we can produce a final solution for the time evolution of an initial wave function, in terms of a Green's function
for the wave equation.

\begin{equation}\label{eqn:wave_fourier:greensSolution}
\begin{aligned}
{\psi}(x,y,t) &= \IIinf \phi(u,w) G( x-u, y-w, t) du dw \\
G(x,y,t) &= \inv{({2\pi})^2} \IIinf \exp\left( i k x + i m y \pm i \sqrt{k^2 + m^2} v t \right) dk dm
\end{aligned}
\end{equation}

Pretty cool even if it is incomplete.

\subsection{A (busted) attempt to reduce this Green's function to deltas}

Now, for this inner integral kernel in \eqnref{eqn:wave_fourier:greensSolution}, our Green's function, or fundamental solution for the wave equation,
we expect to have the action of a delta function.  If it weare not for that root term we could make that
identification easily since it could be factored into independent bits:

\begin{equation}\label{eqn:waveFourier:363}
\begin{aligned}
\inv{({2\pi})^2} &\IIinf \exp\left( i k (x-u) + i m (y-w) \right) dk dm  \\
&=
\left(\inv{{2\pi}} \IIinf \exp\left( i k (x-u) \right) dk \right)
\left(\inv{{2\pi}} \IIinf \exp\left( i m (y-w) \right) dm \right) \\
&\sim \delta( x - u)\delta( y - w)
\end{aligned}
\end{equation}

Having seen previously that functions of the form \(f(\kcap \cdot \Bx -v t)\) are general solutions to the wave equation in higher
dimensions suggests rewriting the integral kernel of the wave function in the following form

\begin{equation}\label{eqn:waveFourier:383}
\begin{aligned}
\inv{({2\pi})^2} &\IIinf \exp\left( i k (x-u) + i m (y-w) \pm i \sqrt{k^2 + m^2} v t \right) dk dm \\
&=
\inv{{2\pi}} \IIinf dk \exp\left( i k (x - u \pm v t) \right) \\
&\times \inv{{2\pi}} \IIinf dm \exp\left( i m (y - w \pm v t) \right) \\
&\times \exp\left( \pm i v t ( \sqrt{k^2 + m^2} -k - m ) \right) \\
\end{aligned}
\end{equation}

Now, the first two integrals have the form that we associate with one dimensional delta functions, and one can see that when either
\(k\) or \(m\) separately large (and positive) relative to the other than the third factor is approximately zero.  In a loose fashion one
can guesstimate that this combined integral has the following delta action

\begin{equation}\label{eqn:waveFourier:403}
\begin{aligned}
\inv{({2\pi})^2} &\IIinf \exp\left( i k (x-u) + i m (y-w) \pm i \sqrt{k^2 + m^2} v t \right) dk dm \\
&\sim
\delta( x -u \pm vt )
\delta( y -w \pm vt )
\end{aligned}
\end{equation}

If that is the case then our final solution becomes

\begin{equation}\label{eqn:waveFourier:423}
\begin{aligned}
\psi(x,y,t)
&= \IIinf \phi(u,w) \delta( x -u \pm vt ) \delta( y -w \pm vt ) du dw \\
&= \phi( x \pm vt, y \pm vt ) \\
\end{aligned}
\end{equation}

This is a bit different seeming than the unit wave number dot product form, but lets see if it works.  We want to expand

\begin{equation}\label{eqn:waveFourier:443}
\begin{aligned}
\left(\inv{v^2} \partial_{tt} -\partial_{xx} -\partial_{yy} \right)\psi
%&=
%\inv{v^2} (\pm v)^2 \partial_{xx} \phi
%+\inv{v^2} (\pm v)^2 \partial_{yy} \phi
%-\partial_{xx} \phi
%-\partial_{yy} \phi
\end{aligned}
\end{equation}

Let us start with the time partials

\begin{equation}\label{eqn:waveFourier:463}
\begin{aligned}
\partial_{tt} \phi( x \pm vt, y \pm vt )
&=
\partial_{t} \partial_t \phi( x \pm vt, y \pm vt ) \\
&= \partial_{t} ( \partial_x \phi (\pm v) +\partial_y \phi (\pm v) ) \\
&= (\pm v)( \partial_{x} \partial_t \phi  + \partial_y \partial_t \phi ) \\
&= (\pm v)^2( \partial_{x} (\partial_x \phi + \partial_y \phi)  + \partial_y (\partial_x \phi + \partial_y \phi)) \\
&= (\pm v)^2( \partial_{xx} \phi +\partial_{yy} \phi +\partial_{yx} \phi +\partial_{xy} \phi )
\end{aligned}
\end{equation}

So application of this test solution to the original wave equation is not zero, since these cross partials are not necessarily zero

\begin{equation}\label{eqn:waveFourier:483}
\begin{aligned}
\left(\inv{v^2} \partial_{tt} -\partial_{xx} -\partial_{yy} \right)\psi
&= \partial_{yx} \phi + \partial_{xy} \phi
\end{aligned}
\end{equation}

This indicates that an incorrect guess was made about the delta function action of the integral kernel found
via this Fourier transform technique.  The remainder of that root term does not in fact cancel out, which appeared may
occur, but was just too convenient.  Oh well.

\section{Three dimensional wave function}

It is pretty clear that a three dimensional Fourier transform

\begin{equation}\label{eqn:waveFourier:503}
\begin{aligned}
\hat{f}(k,m,n) &= \inv{(\sqrt{2\pi})^3} \IIinf f(x,y,z) \exp\left( -i k x - i m y - i n z \right) dx dy dz \\
{f}(x,y,z) &= \inv{(\sqrt{2\pi})^3} \IIinf \hat{f}(k,m,n) \exp\left( i k x + i m y + i n z \right) dk dm dn,
\end{aligned}
\end{equation}

applied to a three dimensional wave equation

\begin{equation}\label{eqn:waveFourier:523}
\begin{aligned}
\calF\left( \left(\inv{v^2} \partial_{tt} -\partial_{xx} -\partial_{yy} -\partial_{zz} \right)\psi = 0 \right)
\end{aligned}
\end{equation}

will lead to the similar results, but since this result did not work, it is not worth perusing this more general case just yet.

Despite the failure in the hopeful attempt to reduce the Green's function to a product of delta functions, one still gets a general solution
from this approach for the three dimensional case.

\begin{equation}\label{eqn:wave_fourier:greensSolution3d}
\begin{aligned}
{\psi}(x,y,z,t) &= \IIinf \phi(u,w,r) G( x-u, y-w, z-r, t) du dw dr \\
G(x,y,z,t) &= \inv{({2\pi})^3} \IIinf \exp\left( i k x + i m y + i n z \pm i \sqrt{k^2 + m^2 + n^2} v t \right) dk dm dn
\end{aligned}
\end{equation}

So, utilizing this or reducing it to the familiar \(f(\kcap \cdot \Bx \pm vt)\) solutions becomes the next step.  Intuition says that we
need to pick a different inner product to get that solution.  For the two dimensional case that likely has to be an inner product
with a circular contour, and for the three dimensional case a spherical surface inner product of some sort.

Now, also interestingly, one can see hints here of the non-vacuum Maxwell retarded time potential wave solutions.
This inspires an attempt to try to tackle that too.
