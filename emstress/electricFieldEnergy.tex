%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
\chapter{Field and wave energy and momentum}\label{chap:PJelectricFieldEnergy}
%\date{Jan 03, 2009.  electricFieldEnergy.tex}

\section{Motivation}

The concept of energy in the electric and magnetic fields I am getting closer to understanding, but there is a few ways that I would like to approach it.

I have now explored the Poynting vector energy conservation relationships in
\chapcite{PJpoynting}, and
\chapcite{PJemstresstensor}
, but hhad not understood fully where the energy expressions in the electro and magneto statics cases came from
separately.  I also do not yet know where the \(F \gamma_k F\) terms of the stress tensor fit in the big picture?  I suspect that they can be obtained by Lorentz transforming the rest frame expression \(F \gamma_0 F\) (the energy density, Poynting momentum density four vector).

It also ought to be possible to relate the field energies to a Lagrangian and Hamiltonian, but I have not had success doing so.

The last thing that I had like to understand is how the energy and momentum of a wave can be expressed, both in terms of the abstract conjugate field momentum concept and with a concrete example such as the one dimensional oscillating rod that can be treated in a limiting coupled oscillator approach as in
\citep{goldstein1951cm}.

Once I have got all these down I think I will be ready to revisit Bohm's Rayleigh-Jeans law treatment in \citep{bohm1989qt}.  Unfortunately, each time I try perusing some
interesting aspect of QM I find that I end up back studying electrodynamics, and suspect that needs to be my focus for the foreseeable future (perhaps working thoroughly through Feynman's
volume II).

\section{Electrostatic energy in a field}

Feynman's treatment in
\citep{feynman1963flp}
of the energy \(\frac{\epsilon_0}{2}\BE^2\) associated with the electrostatic \(\BE\) field is very easy to understand.  Here is a write up of this myself without looking at the book to see if I really understood the ideas.

The first step is consideration of the force times distance for two charges gives you the energy required (or gained) by moving one of those charges from infinity to some given separation

\begin{equation}\label{eqn:electricFieldEnergy:20}
\begin{aligned}
W &= \frac{1}{4\pi\epsilon_0} \int_{\infty}^{r} \frac{q_1 q_2}{x^2} \Be_1 \cdot (-\Be_1 dx) \\
&= \frac{q_1 q_2}{4 \pi \epsilon_0 r}
\end{aligned}
\end{equation}

This provides a quantization for an energy in a field concept.  A distribution of charge requires energy to assemble and it is possible to enumerate that energy separately by considering all the charges, or alternatively, by not looking at the final charge distribution, but only considering the net field associated with this charge distribution.  This is a pretty powerful, but somewhat abstract seeming idea.

The generalization to continuous charge distribution from there was pretty straightforward, requiring a double integration over all space

\begin{equation}\label{eqn:electricFieldEnergy:40}
\begin{aligned}
W &= \frac{1}{2} \int \frac{1}{4\pi\epsilon_0} \frac{\rho_1 dV_1 \rho_2 dV_2}{r_{12}}  \\
&= \frac{1}{2} \int \rho_1 \phi_2 dV_1
\end{aligned}
\end{equation}

The \(1/2\) factor was due to double counting all "pairs" of charge elements.  The next step was to rewrite the charge density by using Maxwell's equations.  In terms of the four vector potential Maxwell's equation (with the \(\grad \cdot A = 0\) gauge) is

\begin{equation}\label{eqn:electricFieldEnergy:60}
\begin{aligned}
\grad^2 A = \inv{\epsilon_0 c}( c \rho \gamma_0 + J^k \gamma_k)
\end{aligned}
\end{equation}

So, to write \(\rho\) in terms of potential \(A^0 = \phi\), we have

\begin{equation}\label{eqn:electricFieldEnergy:80}
\begin{aligned}
\left(\inv{c^2}\PDsq{t}{} - \spacegrad^2\right) \phi = \inv{\epsilon_0} \rho
\end{aligned}
\end{equation}

In the statics case, where \(\PD{t}{\phi} = 0\), we can thus write the charge density in terms of the potential

\begin{equation}\label{eqn:electricFieldEnergy:100}
\begin{aligned}
\rho = -\epsilon_0 \spacegrad^2 \phi
\end{aligned}
\end{equation}

and substitute back into the energy summation

\begin{equation}\label{eqn:electricFieldEnergy:120}
\begin{aligned}
W
&= \frac{1}{2} \int \rho \phi dV \\
&= \frac{-\epsilon_0}{2} \int \phi \spacegrad^2 \phi dV \\
\end{aligned}
\end{equation}

Now, Feynman's last step was a bit sneaky, which was to convert the \(\phi \spacegrad^2 \phi\) term into a divergence integral.  Working backwards to derive the identity that he used

\begin{equation}\label{eqn:electricFieldEnergy:140}
\begin{aligned}
\spacegrad \cdot (\phi \spacegrad \phi)
&= \gpgradezero{ \spacegrad (\phi \spacegrad \phi) } \\
&= \gpgradezero{ (\spacegrad \phi) \spacegrad \phi + \phi \spacegrad (\spacegrad \phi) } \\
&= (\spacegrad \phi)^2 + \phi \spacegrad^2 \phi \\
\end{aligned}
\end{equation}

This can then be used with Stokes theorem in its dual form to convert our \(\phi \spacegrad^2 \phi\) the into plain volume and surface integral
\begin{equation}\label{eqn:electricFieldEnergy:160}
\begin{aligned}
W
&= \frac{\epsilon_0}{2} \int \left( (\spacegrad \phi)^2 -\spacegrad \cdot (\phi \spacegrad \phi) \right) dV \\
&= \frac{\epsilon_0}{2} \int (\spacegrad \phi)^2 dV - \frac{\epsilon_0}{2} \int_{\partial V} (\phi \spacegrad \phi) \cdot \ncap dA \\
\end{aligned}
\end{equation}

Letting the surface go to infinity and employing a limiting argument on the magnitudes of the \(\phi\) and \(\spacegrad \phi\) terms was enough to produce the final electrostatics
energy result

\begin{equation}\label{eqn:electricFieldEnergy:180}
\begin{aligned}
W
&= \frac{\epsilon_0}{2} \int (\spacegrad \phi)^2 dV \\
&= \frac{\epsilon_0}{2} \int \BE^2 dV
\end{aligned}
\end{equation}

\section{Magnetostatic field energy}

Feynman's energy discussion of the magnetic field for a constant current loop (magnetostatics), is not so easy to follow.  He considers the dipole moment of a small loop, obtained by comparison to previous electrostatic results (that I had have to go back and read or re-derive) and some
subtle seeming arguments about the mechanical vs. total energy of the system.

\subsection{Biot Savart}

As an attempt to understand all this, let us break it up into pieces.  First, is calculation of the field for a current loop.  Let us also use
this as an opportunity to see how one would work directly and express the Biot-Savart law in the STA formulation.

Going back to Maxwell's equation (with the \(\grad \cdot A\) gauge again), we have

\begin{equation}\label{eqn:electricFieldEnergy:200}
\begin{aligned}
\grad F
&= \grad (\grad \wedge A) \\
&= \grad^2 A^\mu \\
&= J^\mu/\epsilon_0 c
\end{aligned}
\end{equation}

For a static current configuration with \(J^0 = c \rho = 0\), we have \(\PDi{t}{A^\mu} = 0\), and our vector potential equations are

\begin{equation}\label{eqn:electricFieldEnergy:220}
\begin{aligned}
\spacegrad^2 A^k = -J^k/\epsilon_0 c
\end{aligned}
\end{equation}

Recall that the solution of \(A^k\) can be expressed as the impulse response of a function of the following form

\begin{equation}\label{eqn:electricFieldEnergy:240}
\begin{aligned}
A^k = C\inv{r}
\end{aligned}
\end{equation}

and that \(\spacegrad \cdot (\spacegrad (1/r))\) is zero for all \(r \ne 0\).  Performing a volume integral of the expected Laplacian we
can integrate over an infinitesimal spherical volume of radius \(R\)

\begin{equation}\label{eqn:electricFieldEnergy:260}
\begin{aligned}
\int \spacegrad^2 A^k dV
&= C \int \spacegrad \cdot \spacegrad \inv{r} dV \\
&= C \int \spacegrad \cdot \left( -\rcap \inv{r^2} \right) dV \\
&= -C \int_{\partial_V} \rcap \inv{r^2} \cdot \rcap dA \\
&= -C \inv{R^2} 4 \pi R^2 \\
&= - 4 \pi C \\
\end{aligned}
\end{equation}

Equating we can solve for \(C\)

\begin{equation}\label{eqn:electricFieldEnergy:280}
\begin{aligned}
- 4 \pi C &= -J^k/\epsilon_0 c \\
C &= \inv{4 \pi \epsilon_0 c} J^k
\end{aligned}
\end{equation}

Note that this is cheating slightly since C was kind of treated as a constant, whereas this equality makes it a function.  It works because
the infinitesimal volume can be made small enough that \(J^k\) can be treated as a constant.  This therefore provides our
potential function in terms of this impulse response

\begin{equation}\label{eqn:electricFieldEnergy:300}
\begin{aligned}
A^k &= \inv{4 \pi \epsilon_0 c} \int \frac{J^k}{r} dV
\end{aligned}
\end{equation}

Now, this could have all been done with a comparison to the electrostatic result.  Regardless, it now leaves us in the position to
calculate the field bivector

\begin{equation}\label{eqn:electricFieldEnergy:320}
\begin{aligned}
F
&= \grad \wedge A \\
&= (\gamma^\mu \wedge \gamma_k) \partial_\mu A^k \\
&= -(\gamma_m \wedge \gamma_k) \partial_m A^k \\
\end{aligned}
\end{equation}

So our field in terms of components is
\begin{equation}\label{eqn:electric_field_energy:magneticComponents}
\begin{aligned}
F &= (\sigma_m \wedge \sigma_k) \partial_m A^k
\end{aligned}
\end{equation}

Which in terms of spatial vector potential \(\BA = A^k \sigma_k\) is also
\begin{equation}\label{eqn:electricFieldEnergy:340}
\begin{aligned}
F &= \spacegrad \wedge \BA
\end{aligned}
\end{equation}

From \eqnref{eqn:electric_field_energy:magneticComponents} we can calculate the field in terms of our potential directly

\begin{equation}\label{eqn:electricFieldEnergy:360}
\begin{aligned}
\partial_m A^k
&= \inv{4 \pi \epsilon_0 c} \int dV \partial_m \frac{J^k}{r} \\
&= \inv{4 \pi \epsilon_0 c} \int dV \left( J^k \partial_m \inv{r} + \inv{r} \partial_m {J^k} \right) \\
&= \inv{4 \pi \epsilon_0 c} \int dV \left( J^k \partial_m \left(\sum_j ((x^j)^2)^{-1/2}\right) + \inv{r} \partial_m {J^k} \right) \\
&= \inv{4 \pi \epsilon_0 c} \int dV \left( J^k \left(-\inv{2}\right) 2 x^m \inv{r^3} + \inv{r} \partial_m {J^k} \right) \\
&= \inv{4 \pi \epsilon_0 c} \int \inv{r^3} dV \left( -x^m J^k + r^2 \partial_m {J^k} \right) \\
\end{aligned}
\end{equation}

So with \(\Bj = J^k \sigma_k\) we have

\begin{equation}\label{eqn:electricFieldEnergy:380}
\begin{aligned}
F
&= \inv{4 \pi \epsilon_0 c} \int \inv{r^3} dV \left( -\Br \wedge \Bj + r^2 (\spacegrad \wedge \Bj) \right) \\
&= \inv{4 \pi \epsilon_0 c} \int dV \left( \frac{\Bj \wedge \rcap}{r^2} + \inv{r}(\spacegrad \wedge \Bj) \right) \\
\end{aligned}
\end{equation}

The first term here is essentially the Biot Savart law once the current density is converted to current \(\int \Bj dV = I \int \jCap dl\), so we expect the second term to be zero.

To calculate the current density divergence we first need the current density in vector form

\begin{equation}\label{eqn:electricFieldEnergy:400}
\begin{aligned}
\Bj
&= -\epsilon_0 c \spacegrad^2 \BA  \\
&= -\epsilon_0 c \gpgradeone{\spacegrad (\spacegrad \BA) } \\
&= -\epsilon_0 c \spacegrad (\spacegrad \cdot \BA) + \spacegrad \cdot (\spacegrad \wedge \BA) \\
\end{aligned}
\end{equation}

Now, recall the gauge choice was

\begin{equation}\label{eqn:electricFieldEnergy:420}
\begin{aligned}
0 &= \grad \cdot A \\
&= \partial_0 A^0 + \partial_k A^k \\
&= \inv{c}\PD{t}{A^0} + \spacegrad \cdot \BA
\end{aligned}
\end{equation}

So, provided we also have \(\PDi{t}{A^0} = 0\), we also have \(\spacegrad \cdot \BA = 0\), which is true due to the assumed static conditions, we are left with

\begin{equation}\label{eqn:electricFieldEnergy:440}
\begin{aligned}
\Bj
&= -\epsilon_0 c \spacegrad \cdot (\spacegrad \wedge \BA) \\
\end{aligned}
\end{equation}

Now we can take the curl of \(\Bj\), also writing this magnetic field \(F\) in its dual form \(F = i c \BB\), we see that the curl of our static current density vector is zero:

\begin{equation}\label{eqn:electricFieldEnergy:460}
\begin{aligned}
\spacegrad \wedge \Bj
&= \spacegrad \wedge (\spacegrad \cdot F) \\
&= c \spacegrad \wedge (\spacegrad \cdot (i \BB)) \\
&= \frac{c}{2} \spacegrad \wedge (\spacegrad (i \BB) - i \dot{\BB} \dot{\spacegrad} ) \\
&= c \spacegrad \wedge (i \spacegrad \wedge \BB) \\
&= c \spacegrad \wedge (i^2 \spacegrad \cross \BB) \\
&= -ci \spacegrad \cross (\spacegrad \cross \BB) \\
&= 0
\end{aligned}
\end{equation}

This leaves us with
\begin{equation}\label{eqn:electricFieldEnergy:480}
\begin{aligned}
F
&= \inv{4 \pi \epsilon_0 c} \int \frac{\Bj \wedge \rcap}{r^2} dV \\
\end{aligned}
\end{equation}

Which with the current density expressed in terms of current is the desired Biot-Savart law

\begin{equation}\label{eqn:electricFieldEnergy:500}
\begin{aligned}
F &= \inv{4 \pi \epsilon_0 c} \int \frac{I d\Bs \wedge \rcap}{r^2}
\end{aligned}
\end{equation}

Much shorter derivations are possible than this one which was essentially done from first principles.  The one in \citep{doran2003gap}, which also uses the STA formulation, is the shortest I have ever seen, utilizing a vector Green's function for the Laplacian.  However, that requires understanding the geometric calculus chapter of that book, which is a battle for a different day.

\subsection{Magnetic field torque and energy}

TODO: work out on paper and write up.

I created a
\href{http://www.physicsforums.com/showthread.php?p=2072561}{PF thread, electric and magnetic field energy }, to followup on these ideas, and now have
an idea how to proceed.

\section{Complete field energy}

Can a integral of the Lorentz force coupled with Maxwell's equations in their entirety produce the energy expression \(\frac{\epsilon_0}{2}\left(\BE^2 + c^2\BB^2\right)\)?  It seems like cheating to add these arbitrarily and then follow the Poynting derivation by taking derivatives.  That shows this quantity is a conserved quantity, but does it really show that it is the
energy?  One could imagine that there could be other terms in a total energy expression such as \(\BE \cdot \BB\).

Looking in more detail at the right hand side of the energy/Poynting
relationship is the key.   That is

\begin{equation}\label{eqn:electric_field_energy:poyntingConservation}
\begin{aligned}
\PD{t}{}\frac{\epsilon_0}{2} \left(\BE^2 + c^2 \BB^2\right) + c^2 \epsilon_0 \spacegrad \cdot (\BE \cross \BB) &= -\BE \cdot \Bj
\end{aligned}
\end{equation}

Two questions to ask.  The first is that if the left hand side is to be
a conserved quantity then we need the right hand side to be one too?
Is that really the case?
Second, how can this be related to work done (a line integral of the Lorentz
force).

The second question is easiest, and the result actually follows directly.

\begin{equation}\label{eqn:electricFieldEnergy:520}
\begin{aligned}
\text{Work done moving a charge against the Lorentz force}
&= \int \BF \cdot (-d\Bx) \\
&= \int q ( \BE + \Bv \cross \BB ) \cdot (-d\Bx) \\
&= -\int q ( \BE + \Bv \cross \BB ) \cdot \Bv dt \\
&= -\int q \BE \cdot \Bv dt \\
&= -\int \BE \cdot \Bj dt dV \\
\end{aligned}
\end{equation}

From this we see that \(-\BE \cdot \Bj\) is the rate of change of power density
in an infinitesimal volume!

Let us write
\begin{equation}\label{eqn:electricFieldEnergy:540}
\begin{aligned}
U &= \frac{\epsilon_0}{2} \left(\BE^2 + c^2 \BB^2\right) \\
\BP &= \inv{\mu_0} (\BE \cross \BB)
\end{aligned}
\end{equation}

and now take \eqnref{eqn:electric_field_energy:poyntingConservation} and integrate over a (small)
volume

\begin{equation}\label{eqn:electricFieldEnergy:560}
\begin{aligned}
\int_V \PD{t}{U} dV + \int_{\partial V} \BP \cdot \ncap dA &=
-\int_V (\BE \cdot \Bj ) dV
\end{aligned}
\end{equation}

So, for a small time increment \(\Delta t = t_1 - t_0\),
corresponding to the start and end times of the particle
at the boundaries of the work line integral, we have

\begin{equation}\label{eqn:electricFieldEnergy:580}
\begin{aligned}
\text{ Work done on particle against field } &=
\int_{t_0}^{t_1}
\int_V \PD{t}{U} dV dt +
\int_{t_0}^{t_1}
\int_{\partial V} \BP \cdot \ncap dA dt  \\
&=
\int_V (U(t_1) - U(t_0)) dV +
\int_{t_0}^{t_1}
\int_{\partial V} \BP \cdot \ncap dA dt  \\
&=
\int_V \Delta U dV +
\int_{t_0}^{t_1}
\int_{\partial V} \BP \cdot \ncap dA dt
\end{aligned}
\end{equation}

Roughly speaking, it appears that the energy provided to move a charge against the field is absorbed into the field in one of two parts, one of which is
what gets identified as the energy of the field \(\int U dV\).  The other part is the time integral of the flux through the surface of the volume of this Poynting
vector \(\BP\).

\subsection{Dimensional analysis}

That is a funny looking term though?  Where would we see momentum integrated over time in classical mechanics?

\begin{equation}\label{eqn:electricFieldEnergy:600}
\begin{aligned}
\int m v dt = m x
\end{aligned}
\end{equation}

Let us look at the dimensions of all the terms in the conservation equation.  We have identified the \(\Bj \cdot \BE\) term with energy density, and
should see this

\begin{equation}\label{eqn:electricFieldEnergy:620}
\begin{aligned}
[ \Bj \BE ]
&= [ (q v /x^3) (F/ q) ] \\
&= [ (x /(x^3 t)) (m x/ t^2) ] \\
&= [ m(x^2/t^2) /(x^3 t) ] \\
&= \frac{\text{Energy}}{ \text{Volume} \times \text{Time}}
\end{aligned}
\end{equation}

Good.  That is what should have been the case.

Now, for the \(U\) term we must then have

\begin{equation}\label{eqn:electricFieldEnergy:640}
\begin{aligned}
[ {U} ]
&= \frac{\text{Energy}}{ {Volume} }
\end{aligned}
\end{equation}

Okay, that is good too, since we were calling \(U\) energy density.  Now for the Poynting term we have

\begin{equation}\label{eqn:electricFieldEnergy:660}
\begin{aligned}
[ \spacegrad \cdot \BP ] &= [1/x] [ \BP ]
\end{aligned}
\end{equation}

So we have
\begin{equation}\label{eqn:electricFieldEnergy:680}
\begin{aligned}
[ \BP ] &= [1/x] [ \BP ] \\
&= \frac{\text{Energy} \times \text{velocity} }{ \text{Volume} }
\end{aligned}
\end{equation}

For uniform dimensions of all the terms this suggests that it is perhaps more natural to work with velocity scaled quantity, with

\begin{equation}\label{eqn:electricFieldEnergy:700}
\begin{aligned}
\frac{[ \BP ]}{\text{Velocity}} &= \frac{\text{Energy} }{ \text{Volume} }
\end{aligned}
\end{equation}

Rewriting the conservation equation scaling by a velocity, for which the obvious generic velocity choice is naturally \(c\), we have

\begin{equation}\label{eqn:electricFieldEnergy:720}
\begin{aligned}
\inv{c} \PD{t}{} U + \spacegrad \cdot \frac{\BP}{c} &= -\frac{\Bj}{c} \cdot \BE
\end{aligned}
\end{equation}

Written this way we have \(1/ct\) with dimensions of inverse distance matching the divergence, and the dimensions of \(U\), and \(\BP/c\) are both energy density.  Now it makes a bit more sense to say that the work done moving the charge against the field supplies energy to the field in some fashion between these two terms.

\subsection{A note on the scalar part of the covariant Lorentz force}

The covariant formulation of the Lorentz force equation, when wedged with \(\gamma_0\) has been seen to recover the traditional Lorentz force equation
(with a required modification to use relativistic momentum), but there was a scalar term that was unaccounted for.

Recall that the covariant Lorentz force, with derivatives all in terms of proper time, was

\begin{equation}\label{eqn:electricFieldEnergy:740}
\begin{aligned}
m \dot{p}
&= q F \cdot (v/c) \\
&= \frac{q}{2c} (F v - v F) \\
&= \frac{q}{2c} ((\BE + ic\BB) \gamma_0(\dot{x^0} - \dot{x^k}\sigma_k) - \gamma_0 ( \dot{x^0} - \dot{x^k}\sigma_k) (\BE + i c \BB)) \\
\end{aligned}
\end{equation}

In terms of time derivatives, where factors of \(\gamma\) can be canceled
on each side, we have
\begin{equation}\label{eqn:electricFieldEnergy:760}
\begin{aligned}
m \frac{dp}{dt}
&= \frac{q}{2} \gamma_0 ( (-\BE + ic\BB) (1 - \Bv/c) - ( 1 - \Bv/c) (\BE + i c \BB)) \\
\end{aligned}
\end{equation}

After some reduction this is
\begin{equation}\label{eqn:electricFieldEnergy:780}
\begin{aligned}
m \frac{dp}{dt} &= q ( -\BE \cdot \Bv/c + (\BE + \Bv \cross \BB) ) \gamma_0
\end{aligned}
\end{equation}

Or, with an explicit spacetime split for all components
\begin{equation}\label{eqn:electricFieldEnergy:800}
\begin{aligned}
mc \frac{d\gamma}{dt} &= -q \BE \cdot \Bv/c \\
m \frac{d \gamma \Bv}{dt} &= q (\BE + \Bv \cross \BB) )
\end{aligned}
\end{equation}

We have got the spatial vector Lorentz force in the second term, and now have an idea what this \(-\Bj \cdot \BE\) term is in the energy momentum
vector.  It is not a random thing, but an intrinsic part (previously ignored) of the covariant Lorentz force.

Now recall that when the time variation of the Poynting was studied in \chapcite{PJpoyntingRate} we had what looked like the Lorentz force
components in all the right hand side terms.  Let us reiterate that here, putting all the bits together

\begin{equation}\label{eqn:electricFieldEnergy:820}
\begin{aligned}
\inv{c} \PD{t}{} U + \spacegrad \cdot \frac{\BP}{c} &= -\frac{\Bj}{c} \cdot \BE \\
\inv{c^2}\PD{t}{\BP} + \sum_k \sigma_k \spacegrad \cdot \BT_k &= -(\Bj \cross \BB + \rho \BE)
\end{aligned}
\end{equation}

We have four scalar equations, where each one contains exactly one of the four vector components of the Lorentz force.  This makes the stress
energy tensor seem a lot less random.  Now the interesting thing about this is that each of these equations required nothing more
than a bunch of algebra applied to the Maxwell equation.  Doing so required no use of the Lorentz force, but it shows up magically
as an intrinsic quantity
associated with the Maxwell equation.  Before this I thought that
one really needed both Maxwell's equation and the Lorentz force equation
(or their corresponding Lagrangians), but looking at this result
the Lorentz force seems to more of a property of the field than
a fundamental quantity in its own right (although some means to relate
this stress energy tensor to force is required).
